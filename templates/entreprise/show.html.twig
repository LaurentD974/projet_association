{% extends 'base.html.twig' %}

{% block title %}Fiche entreprise{% endblock %}

{% block body %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="h4 m-0">🏢 Fiche de l'entreprise : {{ entreprise.nom }}</h2>

    {% if app.user and ('ROLE_GACHEUR' in app.user.roles or 'ROLE_ADMIN' in app.user.roles) %}
      <a
        href="{% if 'ROLE_ADMIN' in app.user.roles %}{{ path('admin_dashboard') }}{% else %}{{ path('gacheur_dashboard') }}{% endif %}"
        class="btn {% if 'ROLE_ADMIN' in app.user.roles %}btn-dark{% else %}btn-success{% endif %}">
        {% if 'ROLE_ADMIN' in app.user.roles %}🛠️ Dashboard Admin{% else %}🎯 Dashboard Gâcheur{% endif %}
      </a>
    {% endif %}
  </div>

  {# compat: certaines vues utilisent code_postale, d'autres codePostale #}
  {% set codePostal = entreprise.code_postale is defined ? entreprise.code_postale : (entreprise.codePostale is defined ? entreprise.codePostale : null) %}

  <div class="card shadow-sm">
    <div class="card-header bg-light">
      <h5 class="h6 mb-0">{{ entreprise.nom }}</h5>
    </div>

    <ul class="list-group list-group-flush">
      <li class="list-group-item d-flex justify-content-between">
        <span class="fw-semibold">Responsable</span>
        <span class="text-end">{{ entreprise.responsable ?? '—' }}</span>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span class="fw-semibold">Adresse</span>
        <span class="text-end">{{ entreprise.adresse ?? '—' }}</span>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span class="fw-semibold">Code postal</span>
        <span class="text-end">{{ codePostal ?? '—' }}</span>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span class="fw-semibold">Ville</span>
        <span class="text-end">{{ entreprise.ville ?? '—' }}</span>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span class="fw-semibold">Téléphone</span>
        <span class="text-end">
          {% if entreprise.telephone %}
            <a href="tel:{{ entreprise.telephone }}">{{ entreprise.telephone }}</a>
          {% else %}—{% endif %}
        </span>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span class="fw-semibold">Email</span>
        <span class="text-end">
          {% if entreprise.email %}
            ✉️ <a href="mailto:{{ entreprise.email }}">{{ entreprise.email }}</a>
          {% else %}—{% endif %}
        </span>
      </li>
    </ul>
  </div>

  <div class="d-flex justify-content-between mt-3">
    <a href="{{ path('entreprise_index') }}" class="btn btn-outline-secondary">↩️ Retour à la liste</a>
    <a href="javascript:history.back()" class="btn btn-primary">Page précédente</a>
  </div>
</div>
{% endblock %}
